# Vulnerability Scanner Service

A microservice that scans code dependencies for known security vulnerabilities.

## Features

- Scan package.json files for npm vulnerabilities
- Scan requirements.txt files for Python vulnerabilities
- Provides a risk assessment based on the number and severity of vulnerabilities
- Includes both real scanning (using npm audit and safety) and mock scanning for testing

## API Endpoints

### GET /

Returns service information and available endpoints.

**Response:**
```json
{
  "service": "vulnerability-scanner",
  "status": "running",
  "mode": "mock",
  "endpoints": [
    "/health",
    "/scan"
  ]
}
```

### POST /scan

Scans dependencies for vulnerabilities.

**Request Body:**
```json
{
  "package_file": "package.json",
  "content": "{ \"dependencies\": { \"express\": \"4.17.1\" } }"
}
```

**Parameters:**
- `package_file`: The type of dependency file to scan (currently supports "package.json" and "requirements.txt")
- `content`: The content of the file to scan

**Response:**
```json
{
  "scan_results": {
    "metadata": { ... },
    "vulnerabilities": { ... }
  },
  "summary": {
    "vulnerabilities_found": 2,
    "risk_level": "medium"
  }
}
```

### GET /health

Health check endpoint.

**Response:**
```json
{
  "status": "ok"
}
```

## Usage

### Docker

The service is designed to run in a Docker container. The included Dockerfile sets up the necessary environment.

Build the container:
```
docker build -t vulnerability-scanner .
```

Run the container:
```
docker run -p 4002:4002 -e MOCK_SCANNER=true vulnerability-scanner
```

### Environment Variables

- `MOCK_SCANNER`: Set to "true" to use the mock scanner instead of real tools (default: "true")

## Testing

A test client script is included to test the vulnerability scanner:

```
python scanner/test_client.py --file package.json
```

## Implementation Details

The scanner can work in two modes:

1. **Real Scanning Mode**: Uses npm audit for JavaScript dependencies and safety for Python dependencies
2. **Mock Scanning Mode**: Uses pre-defined vulnerability data for testing purposes

The scanner architecture consists of:

- `vuln_scanner.py`: Main Flask application
- `scanner/scanner.py`: Real vulnerability scanner implementation
- `scanner/mock_scanner.py`: Mock vulnerability scanner implementation
- `scanner/mock_data.py`: Pre-defined vulnerability data for testing
- `scanner/test_client.py`: Test client for the scanner 